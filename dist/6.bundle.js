(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{663:function(t,o,n){"use strict";n.r(o);var e=function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",{staticClass:"bookinfo-box"},[n("div",{staticClass:"mui-card"},[n("div",{staticClass:"mui-card-header"},[t._v("书名："+t._s(t.bookInfoList.bookname))]),t._v(" "),n("div",{staticClass:"mui-card-content"},[n("div",{staticClass:"mui-card-content-inner"},[n("div",{staticClass:"bookinfo-img"},[n("img",{staticClass:"imgclass",attrs:{src:t.bookInfoList.bookimg}})])])]),t._v(" "),n("div",{staticClass:"mui-card-footer"},[n("div",[n("h2",{staticClass:"bookinfo-title"},[t._v("图书信息")]),t._v(" "),n("p",{staticClass:"bookinfo-p"},[t._v("图书ISBN："),n("span",[t._v(t._s(t.bookInfoList.isbn))])]),n("p"),t._v(" "),n("p",{staticClass:"bookinfo-p"},[t._v("作者："),n("span",[t._v(t._s(t.bookInfoList.bookwriter))])]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],staticClass:"bookinfo-p"},[t._v("馆藏余量："),n("span",{staticClass:"bookinfo-span"},[t._v(t._s(t.bookInfoList.booknum))])]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:t.flag1,expression:"flag1"}],staticClass:"bookinfo-p"},[t._v("馆藏余量："),n("span",{staticClass:"bookinfo-span",staticStyle:{color:"red"}},[t._v(t._s(t.bookInfoList.booknum))])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],staticClass:"bookinfo-p-1"},[n("span",{staticClass:"mui-icon mui-icon-extra mui-icon-extra-order bookinfo-spanIcon"}),n("span",{staticClass:"bookinfo-text-span"},[t._v("可预约")]),t._v("\n                        \n                    "),n("span",{staticClass:"mui-icon mui-icon-extra mui-icon-extra-dictionary bookinfo-spanIcon"}),n("span",{staticClass:"bookinfo-text-span"},[t._v("可到馆借阅")])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.flag1,expression:"flag1"}],staticClass:"bookinfo-p-2"},[n("span",{staticClass:"mui-icon mui-icon-extra mui-icon-extra-order bookinfo-spanIcon"}),n("span",{staticClass:"bookinfo-text-span"},[t._v("不可预约")]),t._v("\n                        \n                    "),n("span",{staticClass:"mui-icon mui-icon-extra mui-icon-extra-dictionary bookinfo-spanIcon"}),n("span",{staticClass:"bookinfo-text-span"},[t._v("不可到馆借阅")])])])])]),t._v(" "),n("div",{staticClass:"bookinfo-button"},[n("div",{staticClass:"bookinfo-button-group"},[n("mt-button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],attrs:{type:"primary",size:"normal"},on:{click:t.orderbook}},[t._v("预约图书")]),t._v(" "),n("mt-button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],attrs:{type:"primary",size:"normal"},on:{click:t.openComment}},[t._v("参与书评")]),t._v(" "),n("mt-button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],attrs:{type:"primary",size:"normal"},on:{click:t.openbookinfo}},[t._v("查看简介")])],1),t._v(" "),n("div",{staticClass:"bookinfo-button-group"},[n("mt-button",{directives:[{name:"show",rawName:"v-show",value:t.flag1,expression:"flag1"}],attrs:{type:"danger",size:"normal",disabled:""}},[t._v("预约图书")]),t._v(" "),n("mt-button",{directives:[{name:"show",rawName:"v-show",value:t.flag1,expression:"flag1"}],attrs:{type:"primary",size:"normal"},on:{click:t.openComment}},[t._v("参与书评")]),t._v(" "),n("mt-button",{directives:[{name:"show",rawName:"v-show",value:t.flag1,expression:"flag1"}],attrs:{type:"primary",size:"normal"},on:{click:t.openbookinfo}},[t._v("查看简介")])],1)]),t._v(" "),n("comment",{directives:[{name:"show",rawName:"v-show",value:t.commentflag,expression:"commentflag"}],ref:"child"}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.bookinfoflag,expression:"bookinfoflag"}],staticClass:"mui-card"},[n("div",{staticClass:"mui-card-content"},[n("div",{staticClass:"mui-card-content-inner"},[n("p",{staticClass:"bookinfo-text"},[t._v(" "+t._s(t.bookInfoList.bookinfo))])])])])],1)};e._withStripped=!0;var s=function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",{staticClass:"comment-box"},[n("h3",{staticClass:"h3text"},[t._v("发表评论")]),t._v(" "),n("hr"),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],staticClass:"textare1",attrs:{placeholder:"请输入评论内容（最多120字）",maxlength:"120"},domProps:{value:t.msg},on:{input:function(o){o.target.composing||(t.msg=o.target.value)}}}),t._v(" "),n("mt-button",{attrs:{type:"primary",size:"large"},on:{click:t.postcomment}},[t._v("发表评论")]),t._v(" "),n("div",{staticClass:"cmt-list"},t._l(t.comments,(function(o,e){return n("div",{key:o.id,staticClass:"cmt-item"},[n("div",{staticClass:"cmt-title"},[t._v("\n                第"+t._s(e+1)+"楼   用户:"+t._s(o.username)+"  发布时间："+t._s(t._f("dataFormat")(o.time,"YYYY-MM-DD"))+"\n            ")]),t._v(" "),n("div",{staticClass:"cmt-body"},[t._v("\n                "+t._s(o.comment)+"\n           ")])])})),0)],1)};s._withStripped=!0;var a=n(129),i=n(691),c={name:"comment",data:()=>({comments:[],pageIndex:1,msg:"",name:"",kbpl:!1}),methods:{mounted(){this.$nextTick((function(){this.$on("childmethods1",(function(){console.log("调用子组件");var t=this.$store.getters.getisbn;this.$http.get("api/getcomment?bookisbn="+t).then(t=>{200===t.status?(this.comments=t.body.message,console.log("调用子组件加载评论:"+this.comments)):Object(a.Toast)("获取失败")})}))}));let t=Object(i.b)("username");this.name=t,""===t&&(Object(a.Toast)("评论失败，请先登陆！"),this.$router.push("/error"))},getComments(){var t=this.$store.getters.getisbn;this.$http.get("api/getcomment?bookisbn="+t).then(t=>{200===t.status?this.comments=JSON.parse(t.body.message):Object(a.Toast)("获取失败")})},postcomment(){let t=Object(i.b)("username");if(""===t)this.$router.push("/error");else{if(0===this.msg.trim().length)return Object(a.Toast)("评论数据空！");var o=this.$store.getters.getisbn,n=localStorage.getItem("bookname");console.log("获取书名"+n);var e=t;console.log(e+"*****这个是用户名");var s=function(t){var o=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var e=t.getDate();e=e<10?"0"+e:e;var s=t.getHours(),a=t.getMinutes();a=a<10?"0"+a:a;var i=t.getSeconds();return o+"-"+n+"-"+e+" "+s+":"+a+":"+(i=a<10?"0"+i:i)}(new Date);console.log(this.$store.getters.getUserName);var c={username:e,bookisbn:o,bookname:n,comment:this.msg.trim(),time:s,displaycomment:"Y"};console.log("评论数据："+c),this.$http.post("api/postcomment",c).then((function(t){if(200===t.body.status){var o={username:e,time:s,comment:this.msg.trim(),displaycomment:"Y"};Object(a.Toast)("评论成功"),this.comments.unshift(o),this.msg=""}else Object(a.Toast)("评论失败")}))}}},props:["id"],created(){this.getComments(),this.$emit("getcomment")},updated(){this.comments.forEach((t,o)=>{"N"===t.displaycomment&&this.comments.splice(o,1)})}},r=(n(776),n(128)),m=Object(r.a)(c,s,[],!1,null,"63caa0ad",null);m.options.__file="src/components/cubcomponent/comment.vue";var l={name:"bookinfo",components:{comment:m.exports},data(){return{id:this.$route.params.id,bookInfoList:[],flag:!0,flag1:!1,commentflag:!1,comments:[],bookinfoflag:!1}},methods:{getBookInfo(t){this.$http.get("api/bookinfo?id="+t).then(t=>{200===t.status&&(this.bookInfoList=t.body.message,this.$store.commit("addisbn",t.body.message.isbn),localStorage.setItem("isbn",t.body.message.isbn),this.$store.commit("addbookname",t.body.message.bookname),localStorage.setItem("bookname",t.body.message.bookname),0===parseInt(t.body.message.booknum)&&(this.flag=!1,this.flag1=!this.flag1))})},openComment(){this.commentflag=!this.commentflag,this.$refs.child.getComments(),this.bookinfoflag=!1},openbookinfo(){this.bookinfoflag=!this.bookinfoflag,this.commentflag=!1},orderbook(){this.$router.push({path:"/book/orderbook/"+this.id})}},created(){this.getBookInfo(this.id)}},d=(n(778),Object(r.a)(l,e,[],!1,null,"062dc5c6",null));d.options.__file="src/components/book/bookinfo.vue";o.default=d.exports},691:function(t,o,n){"use strict";function e(t,o,n){var e=new Date;e.setSeconds(e.getSeconds()+n),document.cookie=t+"="+escape(o)+"; expires="+e.toGMTString(),console.log(document.cookie)}function s(t){if(document.cookie.length>0){let o=document.cookie.indexOf(t+"=");if(-1!=o){o=o+t.length+1;let n=document.cookie.indexOf(";",o);return-1==n&&(n=document.cookie.length),unescape(document.cookie.substring(o,n))}}return""}function a(t){e(t,"",-1)}n.d(o,"c",(function(){return e})),n.d(o,"b",(function(){return s})),n.d(o,"a",(function(){return a}))},710:function(t,o,n){var e=n(55),s=n(777);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var a={insert:"head",singleton:!1},i=(e(s,a),s.locals?s.locals:{});t.exports=i},711:function(t,o,n){var e=n(55),s=n(779);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var a={insert:"head",singleton:!1},i=(e(s,a),s.locals?s.locals:{});t.exports=i},776:function(t,o,n){"use strict";var e=n(710);n.n(e).a},777:function(t,o,n){(o=n(56)(!1)).push([t.i,"\n.h3text[data-v-63caa0ad]{\n    font-size: 18px;\n}\n.textare1[data-v-63caa0ad]{\n    font-size: 14px;\n    height: 85px;\n    margin: 0;\n}\n.cmt-body[data-v-63caa0ad]{\n    line-height: 35px;\n    text-indent: 2em;\n}\n.cmt-list[data-v-63caa0ad]{\n    margin: 5px 0;\n}\n.cmt-title[data-v-63caa0ad]{\n    background-color: #b9b4c0;\n    font-size: 13px;\n    border-radius: 3px;\n    text-indent: 0.5em;\n}\n.cmt-item[data-v-63caa0ad]{\n}\n.comment-box[data-v-63caa0ad]{\n\n    padding: 10px 15px;\n}\n\n",""]),t.exports=o},778:function(t,o,n){"use strict";var e=n(711);n.n(e).a},779:function(t,o,n){(o=n(56)(!1)).push([t.i,"\n.bookinfo-box[data-v-062dc5c6]{\n}\n.bookinfo-title[data-v-062dc5c6]{\n    font-size: 18px;\n    margin-bottom: 10px;\n}\n.bookinfo-p[data-v-062dc5c6]{\n    font-size: 16px;\n    color: #555555;\n}\n.bookinfo-span[data-v-062dc5c6]{\n    font-size: 16px;\n    font-weight: bold;\n    color: #5092f0;\n}\n.bookinfo-p-1[data-v-062dc5c6]{\n    font-size: 13px ;\n    color:#5092f0;\n    display: flex;\n    justify-content: space-between;\n}\n.bookinfo-p-2[data-v-062dc5c6]{\n    font-size: 13px ;\n    color: #ff2d3c;\n    display: flex;\n    justify-content: space-between;\n}\n.bookinfo-spanIcon[data-v-062dc5c6]{\n    font-size: 25px ;\n}\n.bookinfo-text-span[data-v-062dc5c6]{\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    font-size: 15px;\n}\n.bookinfo-button[data-v-062dc5c6]{\n\n    display: flex;\n    justify-content: center;\n}\n.bookinfo-text[data-v-062dc5c6]{\n    margin: 5px;\n    font-size: 18px;\n    color: black;\n}\n.bookinfo-img[data-v-062dc5c6]{\n    display: flex;\n    justify-content: center;\n}\n.imgclass[data-v-062dc5c6]{\n    height: 240px;\n    width: 210px;\n}\n\n",""]),t.exports=o}}]);